<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity"
            prefHeight="800.0" prefWidth="1200.0"
            stylesheets="@styles.css"
            xmlns="http://javafx.com/javafx/19"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.taller.proyecto_bd.ui.ConsultasReportesController">

   <!-- ==================== TÃTULO SUPERIOR ==================== -->
   <top>
      <VBox style="-fx-background-color: #2c3e50; -fx-padding: 15;">
         <children>
            <Label text="ðŸ“Š Consultas y Reportes" textFill="white">
               <font>
                  <Font name="System Bold" size="20.0" />
               </font>
            </Label>
            <Label text="AnÃ¡lisis de datos y generaciÃ³n de reportes del sistema" textFill="#ecf0f1">
               <font>
                  <Font size="12.0" />
               </font>
               <VBox.margin>
                  <Insets top="5.0" />
               </VBox.margin>
            </Label>
         </children>
      </VBox>
   </top>

   <!-- ==================== TABS: CONSULTAS Y REPORTES ==================== -->
   <center>
      <TabPane tabClosingPolicy="UNAVAILABLE" BorderPane.alignment="CENTER">
         <tabs>
            <!-- ==================== TAB 1: CONSULTAS ==================== -->
            <Tab text="ðŸ“‹ Consultas">
               <content>
                  <ScrollPane fitToWidth="true" style="-fx-background-color: white;">
                     <content>
                        <VBox spacing="15.0" style="-fx-padding: 20;">
                           <children>
                              <!-- Consulta 1: Productos por CategorÃ­a -->
                              <TitledPane text="1. Productos por CategorÃ­a" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Consulta de todos los productos organizados por categorÃ­a" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#consultaProductosCategoria" styleClass="btn-primary" text="Ejecutar Consulta" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Consulta 2: Clientes con CrÃ©dito Activo -->
                              <TitledPane text="2. Clientes con CrÃ©dito Activo" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Lista de clientes que tienen crÃ©ditos activos en el sistema" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#consultaClientesCredito" styleClass="btn-primary" text="Ejecutar Consulta" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Consulta 3: Ventas Detalle -->
                              <TitledPane text="3. Detalle de Ventas" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Consulta detallada de todas las ventas con informaciÃ³n completa" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#consultaVentasDetalle" styleClass="btn-primary" text="Ejecutar Consulta" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Consulta 4: Productos con Bajo Stock -->
                              <TitledPane text="4. Productos con Bajo Stock" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Productos que requieren reabastecimiento (stock menor al mÃ­nimo)" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#consultaProductosBajoStock" styleClass="btn-primary" text="Ejecutar Consulta" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Consulta 5: Tipos de Venta por Periodo -->
                              <TitledPane text="5. Ventas CrÃ©dito vs Contado por Periodo" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Cantidad de ventas a crÃ©dito vs contado en un periodo determinado" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#consultaTiposVentaPeriodo" styleClass="btn-primary" text="Ejecutar Consulta" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Consulta 6: CrÃ©ditos Activos -->
                              <TitledPane text="6. CrÃ©ditos Activos" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Lista de crÃ©ditos activos en el sistema con informaciÃ³n detallada" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#consultaCreditosActivos" styleClass="btn-primary" text="Ejecutar Consulta" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>
                           </children>
                        </VBox>
                     </content>
                  </ScrollPane>
               </content>
            </Tab>

            <!-- ==================== TAB 2: REPORTES ==================== -->
            <Tab text="ðŸ“ˆ Reportes">
               <content>
                  <ScrollPane fitToWidth="true" style="-fx-background-color: white;">
                     <content>
                        <VBox spacing="15.0" style="-fx-padding: 20;">
                           <children>
                              <!-- Reporte 1: Total Ventas del Mes -->
                              <TitledPane text="1. Total de Ventas del Mes" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Calcular el total de ventas durante un mes determinado" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteVentasMes" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 2: IVA por Trimestre -->
                              <TitledPane text="2. IVA a Pagar por Trimestre" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Generar reporte del valor total de IVA a pagar a la DIAN durante un trimestre" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteIVATrimestre" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 3: Inventario por CategorÃ­a -->
                              <TitledPane text="3. Inventario por CategorÃ­a" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Obtener inventario de productos por categorÃ­a con su costo asociado" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteInventarioPorCategoria" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 4: Clientes Morosos -->
                              <TitledPane text="4. Reporte de Clientes Morosos" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Generar reporte de clientes que compraron a crÃ©dito y estÃ¡n atrasados en sus cuotas" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteClientesMorosos" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 5: Resumen General de Ventas -->
                              <TitledPane text="5. Resumen General de Ventas" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="EstadÃ­sticas generales de ventas con grÃ¡ficos" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteResumenVentas" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 6: Inventario Valorizado -->
                              <TitledPane text="6. Inventario Valorizado" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Valor total del inventario (costo de compra)" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteInventarioValorizado" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 7: Estado de Cartera -->
                              <TitledPane text="7. Estado de Cartera de CrÃ©ditos" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="AnÃ¡lisis completo de crÃ©ditos activos y pagados" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteEstadoCartera" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 8: Top Productos MÃ¡s Vendidos -->
                              <TitledPane text="8. Top Productos MÃ¡s Vendidos" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="Ranking de productos mÃ¡s vendidos" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteTopProductos" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>

                              <!-- Reporte 9: AnÃ¡lisis de IVA -->
                              <TitledPane text="9. AnÃ¡lisis General de IVA" expanded="false">
                                 <content>
                                    <VBox spacing="10.0" style="-fx-padding: 10;">
                                       <children>
                                          <Label text="AnÃ¡lisis completo del IVA recaudado en ventas" wrapText="true" />
                                          <HBox alignment="CENTER_LEFT" spacing="10.0">
                                             <children>
                                                <Button onAction="#reporteAnalisisIVA" styleClass="btn-success" text="Generar Reporte" />
                                             </children>
                                          </HBox>
                                       </children>
                                    </VBox>
                                 </content>
                              </TitledPane>
                           </children>
                        </VBox>
                     </content>
                  </ScrollPane>
               </content>
            </Tab>
         </tabs>
      </TabPane>
   </center>

   <!-- ==================== ÃREA DE RESULTADOS ==================== -->
   <bottom>
      <VBox spacing="10.0" style="-fx-padding: 15; -fx-background-color: #ecf0f1;" BorderPane.alignment="CENTER">
         <children>
            <!-- TÃ­tulo del Resultado -->
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <children>
                  <Label fx:id="lblTituloResultado" text="Resultados" textFill="#2c3e50">
                     <font>
                        <Font name="System Bold" size="14.0" />
                     </font>
                  </Label>
                  <Region HBox.hgrow="ALWAYS" />
                  <Button fx:id="btnExportarPDF" mnemonicParsing="false" onAction="#exportarAPDF"
                          styleClass="btn-danger" text="ðŸ“„ Exportar PDF" disable="true" />
                  <Button fx:id="btnExportar" mnemonicParsing="false" onAction="#exportarResultados"
                          styleClass="btn-primary" text="ðŸ“Š Exportar CSV" disable="true" />
               </children>
            </HBox>

            <Separator />

            <!-- Tabla de Resultados -->
            <TableView fx:id="tablaResultados" prefHeight="200.0">
               <placeholder>
                  <Label text="No hay resultados para mostrar" textFill="#7f8c8d" />
               </placeholder>
            </TableView>

            <!-- Panel de Resumen -->
            <VBox fx:id="panelResumen" spacing="5.0" visible="false" managed="false">
               <children>
                  <Label text="ðŸ“Š Resumen" textFill="#2c3e50">
                     <font>
                        <Font name="System Bold" size="12.0" />
                     </font>
                  </Label>
                  <TextArea fx:id="txtResumen" editable="false" prefHeight="80.0"
                            style="-fx-font-family: 'Courier New'; -fx-font-size: 11;" />
               </children>
            </VBox>

            <!-- Panel de GrÃ¡fica -->
            <VBox fx:id="panelGrafica" spacing="5.0" visible="false" managed="false">
               <children>
                  <Label text="ðŸ“ˆ GrÃ¡fica" textFill="#2c3e50">
                     <font>
                        <Font name="System Bold" size="12.0" />
                     </font>
                  </Label>
               </children>
            </VBox>
         </children>
      </VBox>
   </bottom>
</BorderPane>
